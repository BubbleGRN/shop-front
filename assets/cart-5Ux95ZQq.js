import{S as N,ae as R,ad as S,R as A,G as E,c as v,Y as n,$ as g,X as s,L as t,aw as h,ai as u,W as y,_ as I,O as C,af as i,ag as w,aR as q,V as z,aj as D,am as P}from"./index-DxViBRSc.js";import{V as p,a as j}from"./VRow-C1Nl2xHo.js";import{V as b}from"./VDivider-CF_3VQiG.js";import{V as F,a as G}from"./VList-BJQbahFz.js";import{V as O}from"./VContainer-Sf8phBHd.js";const T={class:"text-center"},K={__name:"cart",setup(U){const{apiAuth:d}=P(),m=N(),x=R(),_=S(),{t:k}=A(),c=E([]),V=async()=>{try{const{data:e}=await d.get("/user/cart");c.value=e.result}catch(e){console.log(e)}};V();const B=v(()=>c.value.reduce((e,r)=>e+r.product.price*r.quantity,0)),$=v(()=>c.value.length>0&&c.value.every(e=>e.product.sell)),f=async(e,r)=>{var a,l;try{const{data:o}=await d.patch("/user/cart",{product:e,quantity:r});m.cart=o.result,V()}catch(o){console.log(o),_({text:k("api."+(((l=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},L=async()=>{var e,r;try{await d.post("/order"),m.cart=0,x.push("/orders")}catch(a){console.log(a),_({text:k("api."+(((r=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(e,r)=>(n(),g(O,null,{default:s(()=>[t(j,null,{default:s(()=>[t(p,{cols:"12"},{default:s(()=>[h("h1",T,u(e.$t("nav.cart")),1)]),_:1}),t(b),t(p,{cols:"12"},{default:s(()=>[t(F,{lines:"two"},{default:s(()=>[(n(!0),y(C,null,I(c.value,(a,l)=>(n(),y(C,{key:a._id},[t(G,{title:a.product.name,subtitle:a.product.price,"active-class":"bg-red",active:!a.product.sell},{prepend:s(()=>[t(q,{rounded:"0"},{default:s(()=>[t(z,{src:a.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[t(i,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:o=>f(a.product._id,-1)},null,8,["onClick"]),w(" "+u(a.quantity)+" ",1),t(i,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:o=>f(a.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<c.value.length-1?(n(),g(b,{key:0})):D("",!0)],64))),128))]),_:1})]),_:1}),t(p,{cols:"12",class:"text-center"},{default:s(()=>[h("p",null,u(B.value),1),t(i,{color:"primary",disabled:!$.value,onClick:L},{default:s(()=>[w(u(e.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};export{K as default};
